import{M as y}from"./bootstrap.esm-5e9b5585.js";import{_ as P,o as c,c as r,a as t,f as d,i as U,F as g,e as b,n as v,j as I,C as T,t as p,D as k,d as _,B as x,A as m,h as w}from"./index-4e1062d4.js";const{VITE_APP_URL:u,VITE_APP_PATH:f}={VITE_APP_URL:"https://vue3-course-api.hexschool.io",VITE_APP_PATH:"owl",VITE_APP_TOKEN:"eyJhbGciOiJSUzI1NiIsImtpZCI6InRCME0yQSJ9.eyJpc3MiOiJodHRwczovL3Nlc3Npb24uZmlyZWJhc2UuZ29vZ2xlLmNvbS92dWUtY291cnNlLWFwaSIsImF1ZCI6InZ1ZS1jb3Vyc2UtYXBpIiwiYXV0aF90aW1lIjoxNjkwMjc0ODI5LCJ1c2VyX2lkIjoiU2VwMmhQWTZRS2JuWjlQM2p2RHFWaHQyYjRSMiIsInN1YiI6IlNlcDJoUFk2UUtiblo5UDNqdkRxVmh0MmI0UjIiLCJpYXQiOjE2OTAyNzQ4MjksImV4cCI6MTY5MDcwNjgyOSwiZW1haWwiOiJzYW0xMjQ2NzQ3QGhvdG1haWwuY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsImZpcmViYXNlIjp7ImlkZW50aXRpZXMiOnsiZW1haWwiOlsic2FtMTI0Njc0N0Bob3RtYWlsLmNvbSJdfSwic2lnbl9pbl9wcm92aWRlciI6InBhc3N3b3JkIn19.X8LCS7AiUzj22H-l6baP_q5_2tsI4Hq2jRVFRtk4J7_qFNM2FjPiTUEr071YBhlQ3CyYzGXzI9ux_DCsV64DjdrRHPLqun0o8jGZFSpzT1ow-wxZl9CMtgCIytNJCsIWrTpUEfwat_YuI3U4T0LqfGDVZEYC91XSTWtkZ92PjoBcnrLEfmWh96jN9dpkLn2fDH9oLgVv6EM8vB9bkYeGigTpCVmIE0xISkB8p_rd_9kt_9vHW2AgvELNp3XrRn2SbtWdtWRKL_r6IivKij80fHQWX17trlre4iayDiRcd3MVjS_1_fi_QD6pIDtvO5Q65ohaHnT51MGTS4mROFKVHA",BASE_URL:"/owl/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},M={data(){return{sortStyle:"asc",myModal:null,editTemplateProduct:{id:"",unit:"",origin_price:"",price:"",category:"",title:"",time:{openTimes:"",publicHoliday:""},address:"",content:"",imagesUrl:[{imageUrl:"",imageAlt:"",timeStamp:""}],googleMapUrl:""},getProductsList:[],renderProductsList:[],imageUpdateUrl:"",pagination:{total_pages:0,current_page:0,has_pre:!1,has_next:!1,category:""}}},methods:{openModal(o){this.myModal.show(),this.editTemplateProduct=o},hideModal(){this.myModal.hide()},submitModal(o){const e=`${u}/v2/api/${f}/admin/product/${o}`,a={data:this.editTemplateProduct};this.$http.put(e,a).then(l=>{this.getProductsApi(this.pagination.current_page,"餐廳"),this.$swal(l.data.message).then(()=>{this.myModal.hide()})}).catch(l=>{this.$swal(l.data.message).then(()=>{this.myModal.hide()})})},del(o){const e=`${u}/v2/api/${f}/admin/product/${o}`;this.$swal({title:"確定刪除嗎?",text:"你將會無法恢復資料!!",icon:"error",showCancelButton:!0,confirmButtonColor:"#BB8D74",cancelButtonColor:"#919191",confirmButtonText:"確定刪除!"}).then(a=>{a.isConfirmed&&this.$http.delete(e).then(l=>{this.$swal("完成",`${l.data.message}`,"success"),this.getProductsApi(this.pagination.current_page,"餐廳")}).catch(l=>{this.$swal("錯誤",`${l.data.message}`,"error")})})},getProductsApi(o=1,e="餐廳"){const a=`${u}/v2/api/${f}/admin/products?page=${o}&category=${e}`;this.$http.get(a).then(l=>{this.getProductsList=l.data.products,this.pagination=l.data.pagination,this.renderProduct()})},renderProduct(){this.sortStyle==="asc"?this.renderProductsList=[...this.getProductsList].sort((o,e)=>{const a=this.getProductsList.indexOf(o),l=this.getProductsList.indexOf(e);return a-l}):this.sortStyle==="desc"&&(this.renderProductsList=[...this.getProductsList].sort((o,e)=>{const a=this.getProductsList.indexOf(o);return this.getProductsList.indexOf(e)-a}))},check(){const o=`${u}/v2/api/user/check`;this.$http.post(o).then(()=>{this.getProductsApi()}).catch(()=>{alert("驗證失敗，請重新登入"),this.$router.push("/login")})},updateLocalImageAPI(o){const e=o.target.files[0],a=e.name.substring(e.name.lastIndexOf(".")+1).toLowerCase();if(a!=="jpg"&&a!=="png"){alert("上傳檔案只能是 jpg、png 格式!，請注意格式上傳呦");return}const l=new FormData;l.append("file-to-upload",e);const i=`${u}/v2/api/${f}/admin/upload`;this.$http.post(i,l).then(n=>{this.imageUpdateUrl=n.data.imageUrl,this.$swal("成功",n.data.message,"success")}).catch(n=>{this.$swal("錯誤",n.data.message,"error")})},updateImage(){const o={imageUrl:this.imageUpdateUrl,imageAlt:this.editTemplateProduct.title+"圖片",timeStamp:Date.now()};this.editTemplateProduct.imagesUrl.push(o)},deleImg(){this.editTemplateProduct.imagesUrl.pop()}},mounted(){this.myModal=new y(document.querySelector("#editModal"));let o=document.cookie.replace(/(?:(?:^|.*;\s*)owl\s*\=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=o,this.check()}},C={class:"row d-flex viewpoints_top_container admin_top_container"},L=t("div",{class:"col-3 col-lg-2"},[t("h2",{class:"fs-2 fw-bold"},"餐廳")],-1),V={class:"col-6 col-lg-3 col-lg-2 viewpoints_area_container"},S=t("option",{class:"custom_option",selected:"",value:"asc"},"新增時間舊到新",-1),A=t("option",{class:"custom_option",value:"desc"},"新增時間新到舊",-1),W=[S,A],j=w('<div class="d-none d-lg-flex row pt-5 pb-2 admin_title_container"><div class="col-1 admin_title_type"><h5 class="fs-5">類別</h5></div><div class="col-1 admin_title_type"><h5 class="fs-5">縮圖</h5></div><div class="col-2 admin_title_type"><h5 class="fs-5">名稱</h5></div><div class="col-2 admin_title_type"><h5 class="fs-5">時間</h5></div><div class="col-2 admin_title_type"><h5 class="fs-5">地點</h5></div></div>',1),N={class:"row admin_content_list_container"},R={class:"col-1 d-flex admin_content_type"},B=t("h4",{class:"fs-7 d-block d-lg-none me-3"},"類別:",-1),D={class:"fs-7"},Z={class:"col-1 d-flex admin_content_img"},E=t("h4",{class:"fs-7 d-block d-lg-none me-3"},"縮圖:",-1),O=["src","alt"],H={class:"col-2 d-flex admin_content_name"},Y=t("h4",{class:"fs-7 d-block d-lg-none me-3"},"名稱:",-1),J={class:"fs-7"},F={class:"col-2 d-none d-lg-flex admin_content_openTimes"},Q={class:"fs-7"},X={class:"col-2 d-none d-lg-flex admin_content_address"},z={class:"fs-7"},G={class:"d-flex admin_content_btn"},q=["onClick"],$=["onClick"],K={key:0,class:"row mt-6 viewpoints_pagination_container admin_pagination_container"},tt={"aria-label":"Page navigation example",class:"col-12 d-flex"},et={class:"pagination d-flex"},st=t("span",{class:"material-icons"}," arrow_back_ios_new ",-1),it=[st],ot=["onClick"],lt=t("span",{class:"material-icons"}," arrow_forward_ios ",-1),nt=[lt],at={class:"modal fade",id:"editModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},dt={class:"modal-dialog"},ct={class:"modal-content"},rt={class:"modal-header"},_t={class:"modal-title fs-2",id:"exampleModalLabel"},pt={for:"input_is_enabled"},mt=["checked"],ut={class:"modal-body row d-flex"},ht={class:"col-12 col-lg-6 d-flex form_txtInput_container"},gt={class:"d-flex form_txtInput_label_container"},ft={class:"mb-3 mb-lg-2 form_txtInput_label form_txtInput_label_type_container fs-5"},bt=t("h5",{class:"fs-5 me-4 me-lg-0"},"類別",-1),vt={class:"mt-0 mt-lg-3 d-flex input_type_container"},It={for:"input_type_restaurant",class:"d-flex"},xt=t("span",{class:"material-icons material-icons_radio"}," radio_button_unchecked ",-1),yt={for:"input_type_viewpoint",class:"d-flex"},Pt=t("span",{class:"material-icons material-icons_radio"}," radio_button_unchecked ",-1),Ut={for:"input_openTimes",class:"mb-3 mb-lg-2 form_txtInput_label form_txtInput_label_time fs-5"},Tt={class:"d-flex form_txtInput_label_container"},kt={for:"input_address",class:"mb-3 mb-lg-2 form_txtInput_label fs-5"},wt={for:"input_publicHoliday",class:"mb-3 mb-lg-2 input_publicHoliday form_txtInput_label form_txtInput_label_time fs-5"},Mt={class:"mt-0 mt-lg-3"},Ct=t("h5",{class:"fs-5 mb-0 mb-lg-2 form_imageInput_container_title"},"圖片上傳",-1),Lt={class:"imageInput_list_container mt-2 mt-lg-3"},Vt=["src","alt"],St={for:"input_imgUrl",class:"mt-3 mt-lg-2 imageInput_imgUrl_label"},At={class:"mt-3 d-flex imageInput_imgUrl_btn_container"},Wt=t("label",{for:"fileInput",class:"btn imageInput_imgUrl_btn_file_label"},"本地檔案上傳",-1),jt={class:"col-12 col-lg-5 d-flex form_imageInput_container"},Nt={for:"input_sub",class:"d-flex mt-0 form_txtInput_label fs-5"},Rt={class:"mt modal-footer"};function Bt(o,e,a,l,i,n){return c(),r(g,null,[t("div",C,[L,t("div",V,[d(t("select",{name:"timeSort",id:"timeSort",class:"fs-7 py-2 ps-3 ps-lg-6","onUpdate:modelValue":e[0]||(e[0]=s=>i.sortStyle=s),onChange:e[1]||(e[1]=s=>n.renderProduct())},W,544),[[U,i.sortStyle]])])]),j,t("ul",N,[(c(!0),r(g,null,b(i.renderProductsList,s=>(c(),r("li",{key:s.id,class:"d-flex col-6 col-lg-12 py-4 px-0 col12 admin_content_list"},[t("div",R,[B,t("h5",D,p(s.category),1)]),t("div",Z,[E,t("img",{src:s.imagesUrl[0].imageUrl,alt:s.imagesUrl[0].imageAlt},null,8,O)]),t("div",H,[Y,t("h5",J,p(s.title),1)]),t("div",F,[t("h5",Q,p(s.time.openTimes),1)]),t("div",X,[t("h5",z,p(s.address),1)]),t("div",G,[t("button",{type:"button",class:"fs-7 btn form_btn admin_content_btn_edit",onClick:h=>n.openModal(s)}," 編輯 ",8,q),t("button",{type:"button",class:"fs-7 btn form_btn admin_content_btn_del",onClick:h=>n.del(s.id)}," 刪除 ",8,$)])]))),128))]),i.pagination.total_pages!==0?(c(),r("div",K,[t("nav",tt,[t("ul",et,[t("li",{class:v(["page-item",{disabled:!i.pagination.has_pre}])},[t("a",{class:"page-link previous",href:"#","aria-label":"Previous",onClick:e[2]||(e[2]=I(s=>n.getProductsApi(i.pagination.current_page-1),["prevent"]))},it)],2),(c(!0),r(g,null,b(i.pagination.total_pages,s=>(c(),r("li",{class:v(["page-item",{active:s===i.pagination.current_page}]),key:s+"page"},[t("a",{class:"page-link",href:"#",onClick:I(h=>n.getProductsApi(s),["prevent"])},p(s),9,ot)],2))),128)),t("li",{class:v(["page-item",{disabled:!i.pagination.has_next}])},[t("a",{class:"page-link next",href:"#","aria-label":"Next",onClick:e[3]||(e[3]=I(s=>n.getProductsApi(i.pagination.current_page+1),["prevent"]))},nt)],2)])])])):T("",!0),t("div",at,[t("div",dt,[t("div",ct,[t("div",rt,[t("h2",_t,p(i.editTemplateProduct.title),1),t("label",pt,[d(t("input",{type:"checkbox",id:"input_is_enabled",name:"is_enabled","onUpdate:modelValue":e[4]||(e[4]=s=>i.editTemplateProduct.is_enabled=s),checked:i.editTemplateProduct.is_enabled,onChange:e[5]||(e[5]=s=>o.updateIsEnabled())},null,40,mt),[[k,i.editTemplateProduct.is_enabled]]),_(" 啟用 ")])]),t("div",ut,[t("div",ht,[t("div",gt,[t("div",ft,[bt,t("div",vt,[t("label",It,[d(t("input",{name:"input_type",type:"radio",id:"input_type_restaurant",class:"mt-2 form_radio",placeholder:"餐廳","onUpdate:modelValue":e[6]||(e[6]=s=>i.editTemplateProduct.category=s),value:"餐廳"},null,512),[[x,i.editTemplateProduct.category]]),xt,_(" 餐廳 ")]),t("label",yt,[d(t("input",{name:"input_type",type:"radio",id:"input_type_viewpoint",class:"mt-2 form_radio",placeholder:"景點","onUpdate:modelValue":e[7]||(e[7]=s=>i.editTemplateProduct.category=s),value:"景點"},null,512),[[x,i.editTemplateProduct.category]]),Pt,_(" 景點 ")])])]),t("label",Ut,[_(" 營業時間 "),d(t("input",{type:"text",id:"input_openTimes",class:"mt-2 form_txtInput form_txtInput_txt",placeholder:"格式為24小時制:07:00-21:00","onUpdate:modelValue":e[8]||(e[8]=s=>i.editTemplateProduct.time.openTimes=s)},null,512),[[m,i.editTemplateProduct.time.openTimes]])])]),t("div",Tt,[t("label",kt,[_(" 地點 "),d(t("input",{type:"text",id:"input_address",class:"mt-2 form_txtInput form_txtInput_txt",placeholder:"例如:438台中市外埔區溪底路26號 ","onUpdate:modelValue":e[9]||(e[9]=s=>i.editTemplateProduct.address=s)},null,512),[[m,i.editTemplateProduct.address]])]),t("label",wt,[_(" 公休時間 "),d(t("input",{type:"text",id:"input_publicHoliday",class:"mt-2 form_txtInput form_txtInput_txt",placeholder:"輸入公休日","onUpdate:modelValue":e[10]||(e[10]=s=>i.editTemplateProduct.time.publicHoliday=s)},null,512),[[m,i.editTemplateProduct.time.publicHoliday]])])]),t("div",Mt,[Ct,t("ul",Lt,[(c(!0),r(g,null,b(i.editTemplateProduct.imagesUrl,(s,h)=>(c(),r("li",{key:h,class:"imageInput_list_img_container"},[t("img",{src:s.imageUrl,alt:s.imageAlt},null,8,Vt)]))),128))]),t("label",St,[d(t("input",{type:"text",id:"input_imgUrl",class:"imageInput_imgUrl",placeholder:"請輸入圖片連結","onUpdate:modelValue":e[11]||(e[11]=s=>i.imageUpdateUrl=s)},null,512),[[m,i.imageUpdateUrl]])]),t("div",At,[Wt,t("input",{id:"fileInput",type:"file",accept:"image/*",class:"form_btn imageInput_imgUrl_btn_file",onChange:e[12]||(e[12]=(...s)=>n.updateLocalImageAPI&&n.updateLocalImageAPI(...s))},null,32),t("button",{type:"button",class:"btn form_btn imageInput_imgUrl_btn_sure",onClick:e[13]||(e[13]=s=>n.updateImage())}," 確定新增"),t("button",{type:"button",class:"btn form_btn imageInput_imgUrl_btn_del",onClick:e[14]||(e[14]=s=>n.deleImg())}," 刪除圖片 ")])])]),t("div",jt,[t("label",Nt,[_(" 簡介 "),d(t("textarea",{name:"",id:"input_sub",class:"mt-2 form_txtInput form_txtInput_textarea",cols:"100%",rows:"30vh",placeholder:"說明文字....","onUpdate:modelValue":e[15]||(e[15]=s=>i.editTemplateProduct.content=s)},null,512),[[m,i.editTemplateProduct.content]])])])]),t("div",Rt,[t("button",{type:"button",onClick:e[16]||(e[16]=s=>n.hideModal()),class:"fs-7 btn form_btn admin_content_btn_del"}," 關閉 "),t("button",{type:"button",class:"fs-7 btn form_btn admin_content_btn_edit",onClick:e[17]||(e[17]=s=>n.submitModal(i.editTemplateProduct.id))}," 修改發佈 ")])])])])],64)}const Et=P(M,[["render",Bt]]);export{Et as default};
